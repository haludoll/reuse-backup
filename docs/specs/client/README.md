# ReuseBackupClient 仕様書

## 概要

ReuseBackupClientは、新しいiPhone（iOS 17.0+）からReuseBackupServerにメッセージを送信するクライアントアプリケーションです。

## 主な機能

### 1. メッセージ送信機能
- **テキスト入力**: 最大1000文字のメッセージ入力
- **リアルタイム文字数表示**: 入力中の文字数とリミット表示
- **送信状態表示**: 送信中の進捗表示
- **送信結果表示**: 送信成功/失敗の結果表示

### 2. サーバー発見機能
- **自動発見**: Bonjourを使用したサーバー自動発見
- **手動追加**: IPアドレス・ポート番号による手動サーバー追加
- **サーバー一覧**: 発見されたサーバーの一覧表示
- **サーバー状態確認**: 各サーバーの稼働状態確認

### 3. 接続状態管理
- **接続ステータス**: 未接続 / 接続中 / 接続済み / 接続エラー
- **自動再接続**: 接続失敗時の自動再試行
- **手動再接続**: ユーザーによる手動再接続機能

## ユーザーインターフェース

### タブ構成
アプリは2つのタブで構成されています：

1. **メッセージタブ**: メッセージ送信機能
2. **サーバー検索タブ**: サーバー発見・管理機能

### メッセージ送信画面

#### 接続ステータス表示
- **ステータスアイコン**: 接続状態を表すアイコン
  - 円形: 未接続
  - 点線円: 接続中
  - チェックマーク: 接続済み
  - バツマーク: 接続エラー
- **ステータステキスト**: 現在の接続状態を日本語で表示
- **サーバーURL**: 接続中のサーバーURL表示
- **再接続ボタン**: 手動でサーバー再発見を実行

#### メッセージ入力エリア
- **テキストエディタ**: 多行テキスト入力対応
- **文字数カウンター**: リアルタイム文字数表示（最大1000文字）
- **文字数オーバー警告**: 1000文字を超えた場合の警告表示
- **入力制限**: 1000文字を超えた場合の送信ボタン無効化

#### 送信機能
- **送信ボタン**: メッセージ送信実行
- **送信中表示**: 送信処理中のプログレス表示
- **送信完了処理**: 送信成功時の入力フィールドクリア

#### 応答表示
- **最後の応答**: サーバーからの最新レスポンス表示
- **ステータス**: 処理結果ステータス
- **受信確認**: メッセージ受信成功/失敗表示  
- **サーバー時刻**: サーバーでの受信時刻表示

#### エラーハンドリング
- **エラーメッセージ**: 送信失敗時の詳細エラー表示
- **成功アラート**: 送信成功時の確認アラート
- **エラーアラート**: エラー発生時のアラート表示
- **再試行機能**: エラー時の再試行ボタン

### サーバー発見画面

#### 発見状態表示
- **検索中表示**: サーバー発見中のプログレス表示
- **発見結果**: 発見されたサーバー数の表示
- **空状態**: サーバーが見つからない場合の表示

#### サーバー一覧
- **サーバー情報**: 各サーバーの詳細情報表示
  - サーバー名
  - エンドポイント（IPアドレス:ポート）
  - 稼働状態（オンライン/オフライン）
  - サーバーステータス
  - 稼働時間
  - バージョン情報

#### 手動サーバー追加
- **IPアドレス入力**: 手動でのサーバーアドレス入力
- **フォーマット例**: "192.168.1.100:8080"
- **追加ボタン**: 手動サーバーの追加実行

#### 操作機能
- **再検索**: サーバー発見の再実行
- **プルリフレッシュ**: 画面引き下げでの再検索

## 対応デバイス・OS

- **対応OS**: iOS 17.0以上
- **対応デバイス**: iPhone（新しいモデル推奨）
- **ネットワーク**: WiFi接続必須

## 制限事項

- **メッセージ長**: 最大1000文字
- **ネットワーク**: ローカルネットワーク内のみ
- **同時接続**: 1つのサーバーに対してのみ接続
- **セキュリティ**: 基本的なHTTP通信（暗号化なし）

## 関連仕様

- **[API仕様](../api/README.md)** - クライアントが使用するAPI詳細
- **[ネットワーク仕様](../network/README.md)** - Bonjourサービス発見詳細
- **[メッセージング機能](../features/messaging.md)** - メッセージ送信処理詳細
- **[サーバー発見機能](../features/server-discovery.md)** - サーバー発見機能詳細